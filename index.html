<!DOCTYPE html>
<html>
  <head>
    <title>Kuis YouTube Shorts</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        overflow: hidden;
      }

      #video-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
      }

      #youtube-short {
        width: 100%;
        height: 100%;
        border: none;
      }

      #quiz-content {
        position: absolute;
        bottom: 10%;
        left: 50%;
        transform: translateX(-50%);
        background: transparent;
        padding: 10px;
        color: white;
        text-align: center;
        z-index: 1000;
        width: 90%;
        max-width: 300px;
        animation: fadeIn 0.5s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translate(-50%, 20px);
        }
        to {
          opacity: 1;
          transform: translate(-50%, 0);
        }
      }

      #question {
        font-size: 1.2rem;
        margin-bottom: 8px;
        color: #fff;
        text-shadow: 3px 3px 1px rgba(0, 0, 0, 3);
      }

      .answer-btn {
        display: block;
        width: 35%;
        margin: 4px auto;
        padding: 6px;
        background: rgba(243, 8, 8, 0.5);
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: background 0.2s;
      }

      .answer-btn:hover {
        background: rgba(51, 103, 214, 0.5);
      }

      #progress {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 6px 8px;
        border-radius: 4px;
        z-index: 1000;
        font-size: 0.8rem;
      }

      #timer {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: #ff7043;
        font-weight: bold;
        padding: 6px 8px;
        border-radius: 4px;
        z-index: 1000;
        font-size: 0.8rem;
      }

      #score {
        position: absolute;
        top: 50px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 6px 8px;
        border-radius: 4px;
        z-index: 1000;
        font-size: 0.8rem;
      }

      @media (max-width: 600px) {
        #quiz-content {
          width: 85%;
          padding: 8px;
          bottom: 5%;
        }

        #question {
          font-size: 1.2rem;
        }

        .answer-btn {
          padding: 5px;
          font-size: 0.9rem;
        }

        #progress,
        #timer,
        #score {
          font-size: 0.7rem;
          padding: 4px 6px;
        }

        #timer {
          top: 10px;
          left: 10px;
        }

        #progress {
          top: 10px;
          right: 10px;
        }

        #score {
          top: 40px;
          right: 10px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Container Video YouTube -->
    <div id="video-container">
      <div id="timer"></div>
      <div id="progress">Pertanyaan 1 dari 10</div>
      <div id="score">Skor: 0/10</div>
      <iframe
        id="youtube-short"
        src="https://www.youtube.com/embed/qo8YtstT2jA?autoplay=1&mute=0&controls=0&loop=1&playlist=qo8YtstT2jA"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      ></iframe>
    </div>

    <!-- Overlay Kuis -->
    <div id="quiz-content">
      <h3 id="question">Memuat pertanyaan...</h3>
      <div id="answers">
        <!-- Tombol jawaban akan diisi oleh JavaScript -->
      </div>
    </div>

    <script>
      // Konfigurasi Kuis
      const questions = [
        {
          videoId: "qo8YtstT2jA",
          question: "Apa ibukota Indonesia?",
          options: ["Jakarta", "Bandung", "Surabaya", "Medan"],
          correctAnswer: 0,
        },
        {
          videoId: "Ie9LrSJD0Ao",
          question: "2 + 2 × 2 = ?",
          options: ["6", "8", "4", "10"],
          correctAnswer: 0,
        },
        {
          videoId: "ap7OPIHGbGs",
          question: "2 × 2 = ?",
          options: ["6", "8", "4", "10"],
          correctAnswer: 2,
        },
        {
          videoId: "tKLTFD9His0",
          question: "2 + 2 + 2 + 2 + 2 = ?",
          options: ["6", "8", "4", "10"],
          correctAnswer: 3,
        },
        {
          videoId: "FGMA3eVFNz0",
          question: "2 + 0 = ?",
          options: ["2", "8", "4", "10"],
          correctAnswer: 0,
        },
        {
          videoId: "D--2CpUAXZ8",
          question: "0 + 0 = ?",
          options: ["2", "8", "4", "0"],
          correctAnswer: 3,
        },
        {
          videoId: "9B5NkAfJWLk",
          question: "2 x 0 = ?",
          options: ["2", "8", "4", "0"],
          correctAnswer: 3,
        },
        {
          videoId: "Hcx0ZqpOg9M",
          question: "6 - 2 = ?",
          options: ["2", "8", "4", "0"],
          correctAnswer: 2,
        },
        {
          videoId: "4MyNQBBp3qE",
          question: "0 - 2 = ?",
          options: ["-2", "8", "4", "0"],
          correctAnswer: 0,
        },
        {
          videoId: "TucED0fwebk",
          question: "7 + 1 = ?",
          options: ["2", "8", "4", "0"],
          correctAnswer: 1,
        },
      ];

      let currentQuestion = 0;
      let score = 0;
      let player;
      let timer;

      function updateScore() {
        document.getElementById(
          "score"
        ).textContent = `Skor: ${score}/${questions.length}`;
      }

      function startTimer(duration) {
        clearInterval(timer);
        let timeLeft = duration;
        document.getElementById("timer").textContent = `Waktu: ${timeLeft}s`;

        timer = setInterval(() => {
          timeLeft--;
          document.getElementById("timer").textContent = `Waktu: ${timeLeft}s`;

          if (timeLeft <= 0) {
            clearInterval(timer);
            checkAnswer(-1); // Anggap salah
          }
        }, 1000);
      }

      function checkOrientation() {
        if (window.innerHeight > window.innerWidth) {
          alert("Putar HP ke landscape untuk pengalaman lebih baik!");
        }
      }

      // Fungsi untuk memuat pertanyaan
      function loadQuestion() {
        const q = questions[currentQuestion];
        document.getElementById("question").textContent = q.question;

        // Update video YouTube dengan loop dan suara aktif
        document.getElementById(
          "youtube-short"
        ).src = `https://www.youtube.com/embed/${q.videoId}?autoplay=1&mute=0&controls=0&loop=1&playlist=${q.videoId}`;

        // Buat tombol jawaban
        const answersDiv = document.getElementById("answers");
        answersDiv.innerHTML = "";

        q.options.forEach((option, index) => {
          const button = document.createElement("button");
          button.className = "answer-btn";
          button.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
          button.onclick = () => checkAnswer(index);
          answersDiv.appendChild(button);
        });

        // Update progress
        document.getElementById("progress").textContent = `Pertanyaan ${
          currentQuestion + 1
        } dari ${questions.length}`;

        // Mulai timer
        startTimer(30);
        updateScore();
      }

      // Fungsi untuk memeriksa jawaban
      function checkAnswer(answerIndex) {
        clearInterval(timer);
        const q = questions[currentQuestion];

        if (answerIndex === q.correctAnswer) {
          score++;
          currentQuestion++;
          updateScore();

          if (currentQuestion < questions.length) {
            loadQuestion(); // Lanjut ke soal berikut
          } else {
            // Jika semua benar, redirect ke ebook
            if (score === questions.length) {
              window.location.href = "https://www.perpus.org/";
            }
          }
        } else {
          // Jika salah, reset kuis
          alert(
            `Salah! Jawaban yang benar adalah ${String.fromCharCode(
              65 + q.correctAnswer
            )}. ${q.options[q.correctAnswer]}. Silakan coba lagi dari awal.`
          );
          currentQuestion = 0;
          score = 0;
          updateScore();
          loadQuestion();
        }
      }

      // Inisialisasi YouTube Player API
      function onYouTubeIframeAPIReady() {
        player = new YT.Player("youtube-short", {
          events: {
            onReady: onPlayerReady,
            onStateChange: onPlayerStateChange,
          },
        });
      }

      function onPlayerReady(event) {
        event.target.playVideo();
        event.target.unMute(); // Pastikan suara aktif
      }

      function onPlayerStateChange(event) {
        // Jika video selesai, putar ulang (backup untuk loop)
        if (event.data === YT.PlayerState.ENDED) {
          event.target.playVideo();
        }
      }

      // Load YouTube API
      const tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName("script")[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // Mulai kuis saat halaman dimuat
      window.onload = function () {
        loadQuestion();
        checkOrientation();
      };
    </script>
  </body>
</html>
